<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ScmQE.Soundness-Tests</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Symbol">{-#</a> <a id="18" class="Keyword">OPTIONS</a> <a id="26" class="Pragma">--rewriting</a> <a id="38" class="Pragma">--confluence-check</a> <a id="57" class="Symbol">#-}</a>

<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
<a id="96" class="Keyword">open</a> <a id="101" class="Keyword">import</a> <a id="108" href="Agda.Builtin.Equality.Rewrite.html" class="Module">Agda.Builtin.Equality.Rewrite</a>

<a id="139" class="Keyword">module</a> <a id="146" href="ScmQE.Soundness-Tests.html" class="Module">ScmQE.Soundness-Tests</a> <a id="168" class="Keyword">where</a>

<a id="175" class="Keyword">open</a> <a id="180" class="Keyword">import</a> <a id="187" href="Notation.html" class="Module">Notation</a>
<a id="196" class="Keyword">open</a> <a id="201" class="Keyword">import</a> <a id="208" href="ScmQE.Abstract-Syntax.html" class="Module">ScmQE.Abstract-Syntax</a>
<a id="230" class="Keyword">open</a> <a id="235" class="Keyword">import</a> <a id="242" href="ScmQE.Domain-Equations.html" class="Module">ScmQE.Domain-Equations</a>
<a id="265" class="Keyword">open</a> <a id="270" class="Keyword">import</a> <a id="277" href="ScmQE.Auxiliary-Functions.html" class="Module">ScmQE.Auxiliary-Functions</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="ScmQE.Semantic-Functions.html" class="Module">ScmQE.Semantic-Functions</a>

<a id="341" class="Keyword">open</a> <a id="346" class="Keyword">import</a> <a id="353" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a>
  <a id="398" class="Keyword">using</a> <a id="404" class="Symbol">(</a><a id="405" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="408" class="Symbol">;</a> <a id="410" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="414" class="Symbol">;</a> <a id="416" href="Relation.Binary.PropositionalEquality.Core.html#1670" class="Function">cong-app</a><a id="424" class="Symbol">)</a>

<a id="427" class="Keyword">postulate</a>
  <a id="fix-fix"></a><a id="439" href="ScmQE.Soundness-Tests.html#439" class="Postulate">fix-fix</a> <a id="447" class="Symbol">:</a> <a id="449" class="Symbol">(</a><a id="450" href="ScmQE.Soundness-Tests.html#450" class="Bound">f</a> <a id="452" class="Symbol">:</a> <a id="454" href="Notation.html#367" class="Generalizable">D</a> <a id="456" class="Symbol">→</a> <a id="458" href="Notation.html#367" class="Generalizable">D</a><a id="459" class="Symbol">)</a> <a id="461" class="Symbol">→</a> <a id="463" href="Notation.html#535" class="Postulate">fix</a> <a id="467" href="ScmQE.Soundness-Tests.html#450" class="Bound">f</a> <a id="469" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="471" href="ScmQE.Soundness-Tests.html#450" class="Bound">f</a> <a id="473" class="Symbol">(</a><a id="474" href="Notation.html#535" class="Postulate">fix</a> <a id="478" href="ScmQE.Soundness-Tests.html#450" class="Bound">f</a><a id="479" class="Symbol">)</a>

<a id="fix-app"></a><a id="482" href="ScmQE.Soundness-Tests.html#482" class="Function">fix-app</a> <a id="490" class="Symbol">:</a> <a id="492" class="Symbol">(</a><a id="493" href="ScmQE.Soundness-Tests.html#493" class="Bound">f</a> <a id="495" class="Symbol">:</a> <a id="497" class="Symbol">(</a><a id="498" href="Notation.html#352" class="Generalizable">A</a> <a id="500" class="Symbol">→</a> <a id="502" href="Notation.html#367" class="Generalizable">D</a><a id="503" class="Symbol">)</a> <a id="505" class="Symbol">→</a> <a id="507" class="Symbol">(</a><a id="508" href="Notation.html#352" class="Generalizable">A</a> <a id="510" class="Symbol">→</a> <a id="512" href="Notation.html#367" class="Generalizable">D</a><a id="513" class="Symbol">))</a> <a id="516" class="Symbol">(</a><a id="517" href="ScmQE.Soundness-Tests.html#517" class="Bound">a</a> <a id="519" class="Symbol">:</a> <a id="521" href="Notation.html#352" class="Generalizable">A</a><a id="522" class="Symbol">)</a> <a id="524" class="Symbol">→</a>
            <a id="538" href="Notation.html#535" class="Postulate">fix</a> <a id="542" href="ScmQE.Soundness-Tests.html#493" class="Bound">f</a> <a id="544" href="ScmQE.Soundness-Tests.html#517" class="Bound">a</a> <a id="546" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="548" href="ScmQE.Soundness-Tests.html#493" class="Bound">f</a> <a id="550" class="Symbol">(</a><a id="551" href="Notation.html#535" class="Postulate">fix</a> <a id="555" href="ScmQE.Soundness-Tests.html#493" class="Bound">f</a><a id="556" class="Symbol">)</a> <a id="558" href="ScmQE.Soundness-Tests.html#517" class="Bound">a</a>
<a id="560" href="ScmQE.Soundness-Tests.html#482" class="Function">fix-app</a> <a id="568" href="ScmQE.Soundness-Tests.html#568" class="Bound">f</a> <a id="570" class="Symbol">=</a> <a id="572" href="Relation.Binary.PropositionalEquality.Core.html#1670" class="Function">cong-app</a> <a id="581" class="Symbol">(</a><a id="582" href="ScmQE.Soundness-Tests.html#439" class="Postulate">fix-fix</a> <a id="590" href="ScmQE.Soundness-Tests.html#568" class="Bound">f</a><a id="591" class="Symbol">)</a> 

<a id="595" class="Symbol">{-#</a> <a id="599" class="Keyword">REWRITE</a> <a id="607" href="ScmQE.Soundness-Tests.html#482" class="Function">fix-app</a> <a id="615" class="Symbol">#-}</a>

<a id="test-1"></a><a id="620" href="ScmQE.Soundness-Tests.html#620" class="Function">test-1</a> <a id="627" class="Symbol">:</a> <a id="629" class="Symbol">∀</a> <a id="631" class="Symbol">{</a><a id="632" href="ScmQE.Soundness-Tests.html#632" class="Bound">K</a> <a id="634" href="ScmQE.Soundness-Tests.html#634" class="Bound">ρ</a> <a id="636" href="ScmQE.Soundness-Tests.html#636" class="Bound">κ</a><a id="637" class="Symbol">}</a> <a id="639" class="Symbol">→</a>
  <a id="643" href="ScmQE.Semantic-Functions.html#291" class="Function Operator">ℰ⟦</a> <a id="646" class="InductiveConstructor">con</a> <a id="650" href="ScmQE.Soundness-Tests.html#632" class="Bound">K</a> <a id="652" href="ScmQE.Semantic-Functions.html#291" class="Function Operator">⟧</a> <a id="654" href="ScmQE.Soundness-Tests.html#634" class="Bound">ρ</a> <a id="656" href="ScmQE.Soundness-Tests.html#636" class="Bound">κ</a> <a id="658" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="660" href="ScmQE.Soundness-Tests.html#636" class="Bound">κ</a> <a id="662" class="Symbol">(</a><a id="663" href="ScmQE.Semantic-Functions.html#182" class="Function Operator">𝒦⟦</a> <a id="666" href="ScmQE.Soundness-Tests.html#632" class="Bound">K</a> <a id="668" href="ScmQE.Semantic-Functions.html#182" class="Function Operator">⟧</a><a id="669" class="Symbol">)</a>
<a id="671" href="ScmQE.Soundness-Tests.html#620" class="Function">test-1</a> <a id="678" class="Symbol">=</a> <a id="680" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="test-2"></a><a id="686" href="ScmQE.Soundness-Tests.html#686" class="Function">test-2</a> <a id="693" class="Symbol">:</a> <a id="695" class="Symbol">∀</a> <a id="697" class="Symbol">{</a><a id="698" href="ScmQE.Soundness-Tests.html#698" class="Bound">ρ</a> <a id="700" href="ScmQE.Soundness-Tests.html#700" class="Bound">κ</a><a id="701" class="Symbol">}</a> <a id="703" class="Symbol">→</a>
  <a id="707" href="ScmQE.Semantic-Functions.html#291" class="Function Operator">ℰ⟦</a> <a id="710" href="ScmQE.Abstract-Syntax.html#2667" class="InductiveConstructor Operator">⦅eval</a> <a id="716" class="InductiveConstructor">con</a> <a id="720" href="ScmQE.Abstract-Syntax.html#1178" class="InductiveConstructor">#t</a> <a id="723" href="ScmQE.Abstract-Syntax.html#2667" class="InductiveConstructor Operator">⦆</a> <a id="725" href="ScmQE.Semantic-Functions.html#291" class="Function Operator">⟧</a> <a id="727" href="ScmQE.Soundness-Tests.html#698" class="Bound">ρ</a> <a id="729" href="ScmQE.Soundness-Tests.html#700" class="Bound">κ</a> <a id="731" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a>
    <a id="737" href="ScmQE.Auxiliary-Functions.html#2189" class="Function">datum</a> <a id="743" class="Symbol">(</a><a id="744" href="Notation.html#735" class="Postulate">η</a> <a id="746" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="751" href="ScmQE.Domain-Equations.html#1272" class="Postulate Operator">𝐓-in-𝐄</a><a id="757" class="Symbol">)</a> <a id="759" class="Symbol">(λ</a> <a id="762" href="ScmQE.Soundness-Tests.html#762" class="Bound">Δ</a> <a id="764" class="Symbol">→</a> <a id="766" class="Symbol">(</a><a id="767" href="Notation.html#535" class="Postulate">fix</a> <a id="771" href="ScmQE.Semantic-Functions.html#357" class="Function Operator">ℱ_⟦_⟧</a><a id="776" class="Symbol">)</a> <a id="778" href="ScmQE.Auxiliary-Functions.html#2804" class="Function Operator">exp⟦</a> <a id="783" href="ScmQE.Soundness-Tests.html#762" class="Bound">Δ</a> <a id="785" href="ScmQE.Auxiliary-Functions.html#2804" class="Function Operator">⟧</a> <a id="787" href="ScmQE.Auxiliary-Functions.html#377" class="Postulate">nullenv</a> <a id="795" href="ScmQE.Soundness-Tests.html#700" class="Bound">κ</a><a id="796" class="Symbol">)</a>
<a id="798" href="ScmQE.Soundness-Tests.html#686" class="Function">test-2</a> <a id="805" class="Symbol">=</a> <a id="807" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="812" class="Markup">\end{code}</a><a id="822" class="Background">
\clearpage
</a><a id="834" class="Markup">\begin{code}</a>
<a id="a"></a><a id="847" href="ScmQE.Soundness-Tests.html#847" class="Function">a</a> <a id="b"></a><a id="849" href="ScmQE.Soundness-Tests.html#849" class="Function">b</a> <a id="c"></a><a id="851" href="ScmQE.Soundness-Tests.html#851" class="Function">c</a> <a id="d"></a><a id="853" href="ScmQE.Soundness-Tests.html#853" class="Function">d</a> <a id="e"></a><a id="855" href="ScmQE.Soundness-Tests.html#855" class="Function">e</a> <a id="857" class="Symbol">:</a> <a id="859" href="ScmQE.Abstract-Syntax.html#327" class="Datatype">Dat</a>
<a id="863" href="ScmQE.Soundness-Tests.html#847" class="Function">a</a> <a id="865" class="Symbol">=</a> <a id="867" href="ScmQE.Abstract-Syntax.html#1531" class="InductiveConstructor">ide</a> <a id="871" class="String">&quot;a&quot;</a>
<a id="875" href="ScmQE.Soundness-Tests.html#849" class="Function">b</a> <a id="877" class="Symbol">=</a> <a id="879" href="ScmQE.Abstract-Syntax.html#1531" class="InductiveConstructor">ide</a> <a id="883" class="String">&quot;b&quot;</a>
<a id="887" href="ScmQE.Soundness-Tests.html#851" class="Function">c</a> <a id="889" class="Symbol">=</a> <a id="891" href="ScmQE.Abstract-Syntax.html#1531" class="InductiveConstructor">ide</a> <a id="895" class="String">&quot;c&quot;</a>
<a id="899" href="ScmQE.Soundness-Tests.html#853" class="Function">d</a> <a id="901" class="Symbol">=</a> <a id="903" href="ScmQE.Abstract-Syntax.html#1531" class="InductiveConstructor">ide</a> <a id="907" class="String">&quot;d&quot;</a>
<a id="911" href="ScmQE.Soundness-Tests.html#855" class="Function">e</a> <a id="913" class="Symbol">=</a> <a id="915" href="ScmQE.Abstract-Syntax.html#1531" class="InductiveConstructor">ide</a> <a id="919" class="String">&quot;e&quot;</a>

<a id="924" class="Comment">-- R7RS §6.4</a>

<a id="938" class="Comment">-- (a b c d e) and (a . (b . (c . (d . (e . ()))))) are equivalent</a>
<a id="test-proper-list"></a><a id="1005" href="ScmQE.Soundness-Tests.html#1005" class="Function">test-proper-list</a> <a id="1022" class="Symbol">:</a>
  <a id="1026" href="ScmQE.Semantic-Functions.html#200" class="Function Operator">𝒟⟦</a> <a id="1029" href="ScmQE.Abstract-Syntax.html#1660" class="InductiveConstructor Operator">⦅</a> <a id="1031" href="ScmQE.Soundness-Tests.html#847" class="Function">a</a> <a id="1033" class="InductiveConstructor Operator">␣␣</a> <a id="1036" href="ScmQE.Soundness-Tests.html#849" class="Function">b</a> <a id="1038" class="InductiveConstructor Operator">␣␣</a> <a id="1041" href="ScmQE.Soundness-Tests.html#851" class="Function">c</a> <a id="1043" class="InductiveConstructor Operator">␣␣</a> <a id="1046" href="ScmQE.Soundness-Tests.html#853" class="Function">d</a> <a id="1048" class="InductiveConstructor Operator">␣␣</a> <a id="1051" href="ScmQE.Soundness-Tests.html#855" class="Function">e</a> <a id="1053" class="InductiveConstructor Operator">␣␣</a> <a id="1056" class="InductiveConstructor">␣␣␣</a> <a id="1060" href="ScmQE.Abstract-Syntax.html#1660" class="InductiveConstructor Operator">⦆</a> <a id="1062" href="ScmQE.Semantic-Functions.html#200" class="Function Operator">⟧</a> <a id="1064" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a>
  <a id="1068" href="ScmQE.Semantic-Functions.html#200" class="Function Operator">𝒟⟦</a> <a id="1071" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦅</a> <a id="1073" class="InductiveConstructor Operator">␣␣</a> <a id="1076" href="ScmQE.Soundness-Tests.html#847" class="Function">a</a> <a id="1078" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">·</a> <a id="1080" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦅</a> <a id="1082" class="InductiveConstructor Operator">␣␣</a> <a id="1085" href="ScmQE.Soundness-Tests.html#849" class="Function">b</a> <a id="1087" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">·</a> <a id="1089" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦅</a> <a id="1091" class="InductiveConstructor Operator">␣␣</a> <a id="1094" href="ScmQE.Soundness-Tests.html#851" class="Function">c</a> <a id="1096" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">·</a> <a id="1098" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦅</a> <a id="1100" class="InductiveConstructor Operator">␣␣</a> <a id="1103" href="ScmQE.Soundness-Tests.html#853" class="Function">d</a> <a id="1105" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">·</a>  <a id="1108" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦅</a> <a id="1110" class="InductiveConstructor Operator">␣␣</a> <a id="1113" href="ScmQE.Soundness-Tests.html#855" class="Function">e</a> <a id="1115" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">·</a>  <a id="1118" href="ScmQE.Abstract-Syntax.html#1660" class="InductiveConstructor Operator">⦅</a> <a id="1120" class="InductiveConstructor">␣␣␣</a> <a id="1124" href="ScmQE.Abstract-Syntax.html#1660" class="InductiveConstructor Operator">⦆</a> <a id="1126" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦆</a> <a id="1128" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦆</a> <a id="1130" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦆</a> <a id="1132" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦆</a> <a id="1134" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦆</a> <a id="1136" href="ScmQE.Semantic-Functions.html#200" class="Function Operator">⟧</a>
<a id="1138" href="ScmQE.Soundness-Tests.html#1005" class="Function">test-proper-list</a> <a id="1155" class="Symbol">=</a> <a id="1157" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="1163" class="Comment">-- (a b c . d) is equivalent to (a . (b . (c . d)))</a>
<a id="test-improper-list"></a><a id="1215" href="ScmQE.Soundness-Tests.html#1215" class="Function">test-improper-list</a> <a id="1234" class="Symbol">:</a>
  <a id="1238" href="ScmQE.Semantic-Functions.html#200" class="Function Operator">𝒟⟦</a> <a id="1241" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦅</a> <a id="1243" class="Symbol">(((</a><a id="1246" class="InductiveConstructor Operator">␣␣</a> <a id="1249" href="ScmQE.Soundness-Tests.html#847" class="Function">a</a><a id="1250" class="Symbol">)</a> <a id="1252" class="InductiveConstructor Operator">␣␣</a> <a id="1255" href="ScmQE.Soundness-Tests.html#849" class="Function">b</a><a id="1256" class="Symbol">)</a> <a id="1258" class="InductiveConstructor Operator">␣␣</a> <a id="1261" href="ScmQE.Soundness-Tests.html#851" class="Function">c</a><a id="1262" class="Symbol">)</a> <a id="1264" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">·</a> <a id="1266" href="ScmQE.Soundness-Tests.html#853" class="Function">d</a> <a id="1268" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦆</a> <a id="1270" href="ScmQE.Semantic-Functions.html#200" class="Function Operator">⟧</a> <a id="1272" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a>
  <a id="1276" href="ScmQE.Semantic-Functions.html#200" class="Function Operator">𝒟⟦</a> <a id="1279" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦅</a> <a id="1281" class="InductiveConstructor Operator">␣␣</a> <a id="1284" href="ScmQE.Soundness-Tests.html#847" class="Function">a</a> <a id="1286" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">·</a> <a id="1288" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦅</a> <a id="1290" class="InductiveConstructor Operator">␣␣</a> <a id="1293" href="ScmQE.Soundness-Tests.html#849" class="Function">b</a> <a id="1295" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">·</a> <a id="1297" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦅</a> <a id="1299" class="InductiveConstructor Operator">␣␣</a> <a id="1302" href="ScmQE.Soundness-Tests.html#851" class="Function">c</a> <a id="1304" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">·</a> <a id="1306" href="ScmQE.Soundness-Tests.html#853" class="Function">d</a> <a id="1308" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦆</a> <a id="1310" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦆</a> <a id="1312" href="ScmQE.Abstract-Syntax.html#1710" class="InductiveConstructor Operator">⦆</a> <a id="1314" href="ScmQE.Semantic-Functions.html#200" class="Function Operator">⟧</a>
<a id="1316" href="ScmQE.Soundness-Tests.html#1215" class="Function">test-improper-list</a> <a id="1335" class="Symbol">=</a> <a id="1337" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="1342" class="Markup">\end{code}</a></pre></body></html>